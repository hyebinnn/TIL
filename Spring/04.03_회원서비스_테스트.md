[íšŒì› ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸]

### IntelliJ ë‹¨ì¶•í‚¤

- ì´ì „ì—ëŠ” í…ŒìŠ¤íŠ¸í•  ë•Œ test > java > hello.hellospringì—ì„œ testìš© íŒ¨í‚¤ì§€ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í–ˆëŠ”ë°, í›¨ì”¬ ì‰½ê²Œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì´ ì¡´ì¬í•œë‹¤!
  
  - í…ŒìŠ¤íŠ¸í•˜ê³  ì‹¶ì€ classì—ì„œ `cmd+shift+T` â†’ [Create New Test] í´ë¦­
    ì•„ë˜ ì‚¬ì§„ì²˜ëŸ¼ <u>service > MemberServiceTest</u> : **íŒ¨í‚¤ì§€ > íŒŒì¼ ìë™ ìƒì„±**
    
    <img src='./img/04.03_img1.png'>
    
- test íŒŒì¼ì€ ê³¼ê°í•˜ê²Œ í•¨ìˆ˜ëª…ì„ í•œê¸€ë¡œ ì¨ë„ ëœë‹¤!
  

---

- `ctrl + shift + R` : í˜„ì¬ ì½”ë“œ ì¬ì‹¤í–‰
  
- `ctrl + R` : ì´ì „ ì½”ë“œ ì‹¤í–‰ (ìœ ìš©í•˜ê²Œ ì“°ì¸ë‹µë‹ˆë‹¤!)

<br><br>

### Test ë©”ì»¤ë‹ˆì¦˜

- given: ì´ëŸ¬í•œ <u>ìƒí™©ì´ ì£¼ì–´ì¡Œì„ ë•Œ</u>, (í˜„ì¬ testëŠ” ì´ëŸ° ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ”êµ¬ë‚˜!)
  
- when: ì´ê²ƒì„ <u>ì‹¤í–‰í–ˆì„ ë•Œ</u>, (í˜„ì¬ testëŠ” ì´ëŸ° ê²ƒì„ ê²€ì¦í•˜ëŠ”êµ¬ë‚˜!)
  
- then: <u>ê²°ê³¼</u>ëŠ” ì´ë ‡ê²Œ ë‚˜ì™€ì•¼ í•œë‹¤.
  

```java
void íšŒì›ê°€ì…() {
        // given
        Member member = new Member();
        member.setName("hello");

        // when
        Long saveId = memberService.join(member);

        // then
        Member findMember = memberService.findOne(saveId).get();
        org.assertj.core.api.Assertions.assertThat(member.getName()).isEqualTo(findMember.getName());
        // assertThatì€ assertjì˜ Assertionì˜ ë©”ì†Œë“œ!    
}
```

â­ï¸ TestëŠ” ì •ìƒ flowë§Œ ê²€ì¦í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ì˜ˆì™¸ë„ ëŠ˜ ê²€ì¦í•´ì•¼í•œë‹¤!

#### assertThat()

- **assertThat()** ì€ expectedì™€ actualì„ ì•Œë ¤ì£¼ì–´ ê²€ì¦í•˜ê¸° í¸í•˜ë‹¤.
  < true > / < false >
  
  <img src='./img/04.03_img.png'>
  

#### assertThrows()

- ì˜ˆì™¸ ê²€ì¦í•  ë•Œ, ì¼ì¼íˆ try-catchë¬¸ì„ ì‚¬ìš©í•˜ê¸°ë³´ë‹¤ `assertThrows()` ì‚¬ìš© ì¶”ì²œ!
  
  - **assertThrows(`expected ì—ëŸ¬ íƒ€ì…`, `ì‹¤í–‰ logic`)** : íŠ¹ì • logicì„ ì‹¤í–‰í•˜ë©´ expected ì—ëŸ¬ê°€ í„°ì ¸ì•¼ í•œë‹¤.
    
  - assertThrows()ëŠ” ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ return í•´ì¤€ë‹¤.
    

```java
@Test
    public void ì¤‘ë³µíšŒì›_ì˜ˆì™¸() {
        // given
        Member member1 = new Member();
        member1.setName("spring");

        Member member2 = new Member();
        member2.setName("spring");

        // when
        memberService.join(member1);

        try {
            memberService.join(member2);
            fail();             // ì—ëŸ¬ê°€ ë°œìƒí•´ì•¼í•˜ëŠ”ë°(=catchë¡œ ë°”ë¡œ ë„˜ì–´ê°€ì•¼ í•˜ëŠ”ë°) join()ì´ ìˆ˜í–‰ë˜ë©´ fail() -> ì‹¤íŒ¨í•œ ê²ƒì„
        } catch (IllegalStateException e) {
            org.assertj.core.api.Assertions.assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
        }

â†“

@Test
    public void ì¤‘ë³µíšŒì›_ì˜ˆì™¸() {
        // given
        Member member1 = new Member();
        member1.setName("spring");

        Member member2 = new Member();
        member2.setName("spring");

        // when
        memberService.join(member1);
        IllegalStateException e = assertThrows(IllegalStateException.class, () -> memberService.join(member2));
        org.assertj.core.api.Assertions.assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
```

- ë§¤ í•¨ìˆ˜ ëë‚  ë•Œë§ˆë‹¤ ë°ì´í„°ë¥¼ clearí•˜ì§€ ì•Šìœ¼ë©´ DBì— ê³„ì†í•´ì„œ ì €ì¥ë˜ì„œ ì¼íšŒì„± í…ŒìŠ¤íŠ¸ ë¶ˆê°€ëŠ¥
  
<br><br>

### Dependency Injection: ì˜ì¡´ê´€ê³„ì£¼ì…

- ë¬¸ì œ ìƒí™©: ë°ì´í„° clearë¥¼ í•´ì£¼ê¸° ìœ„í•´ <u>MemoryMemberRepository()ë¥¼ newë¡œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ test íŒŒì¼ì—ì„œ ì¶”ê°€ ìƒì„±</u>ì„ í•´ì¤€ ìƒí™©
  
  ```java
  MemoryMemberRepository memberRepository = new MemoryMemberRepository();     //  load for data clear after each method finished
  ```
  
  â†’ ì“¸ë°ì—†ì´ **ë…ë¦½ì ì¸ ê°ì²´ê°€ 2ê°œ**ê°€ ìƒê¸´ ê²ƒì´ê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ ì¸¡ë©´ìœ¼ë¡œ ì•ˆ ì¢‹ê³ , ê°ì²´ê°€ í’ˆê³  ìˆëŠ” ê°’ì´ ê°ê° ë‹¬ë¼ì§€ëŠ” ìƒí™©ì´ ë°œìƒí•  ìˆ˜ë„ ìˆê¸°ì— ì¢‹ì§€ ì•Šë‹¤.
  
  â†’ **ë§Œì•½ DB ì—­í• ì„ í•˜ëŠ” repositoryì˜ ë³¸ í´ë˜ìŠ¤ê°€ static ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ í´ë˜ìŠ¤ê°€ ì•„ë‹ˆë¼ë©´, ì™„ì „íˆ ë‹¤ë¥¸ DBê°€ ìƒê¸´ ê²ƒ**ì´ë¼ í° ë¬¸ì œ ë°œìƒ ê°€ëŠ¥!
  
  ```java
  private static final Map<Long, Member> store = new HashMap<>();
  
  // ì§€ê¸ˆì²˜ëŸ¼ ì €ì¥í•˜ëŠ” DB ì—­í•  ê³µê°„(store)ì´ staticì´ ì•„ë‹ˆì—ˆë‹¤ë©´ ì™„ì „íˆ ë‹¤ë¥¸ DB storeê°€ ìƒê¸°ëŠ” ê²ƒ
  // MemoryMemberRepository.java
  ```
  
  - **âœï¸ solution**: test ë‹¹í•˜ëŠ” í´ë˜ìŠ¤(Memberservice)ì™€ test ë‚´ì˜ repositoryë¥¼ ë™ì¼ì‹œí•´ì£¼ì â†’ testì—ì„œ ë§Œë“  repository ê°ì²´ë¥¼ MemberService í´ë˜ìŠ¤ì—ì„œ ì“°ì
    
  
  ```java
  public class MemberService {
      private final MemberRepository memberRepository = new MemoryMemberRepository();
      ... 
  }
  
  â†“
  
  public class MemberService {
  
      private final MemberRepository memberRepository;
  
      // cmd + N ì„ í†µí•´ constructorì„ generateí•´ì£¼ë©´ ì™¸ë¶€ì˜ ë§¤ê°œë³€ìˆ˜ memberRepositoryë¥¼ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œë” í•¨ìˆ˜ë¥¼ ìë™ ìƒì„±í•´ì£¼ì–´ í¸í•˜ë‹¤!
      public MemberService(MemberRepository memberRepository) {
          this.memberRepository = memberRepository;
      }
  ```
  
- ìœ„ì²˜ëŸ¼ MemberService í´ë˜ìŠ¤ ì…ì¥ì—ì„œ, <u>ì™¸ë¶€ì—ì„œ ë©”ëª¨ë¦¬ repository(DB)ê°€ ë“¤ì–´ì˜¤ëŠ” ê²ƒ</u> = **Dependency Injection ì˜ì¡´ê´€ê³„ ì£¼ì… (DI)**
  
- testëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— beforeEach() í•¨ìˆ˜ë¡œ ê°ê°ì˜ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ ì‹¤í–‰ ì´ì „ì— memberRepositoryì™€ ì„œë¹„ìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
  
  ```java
  class MemberServiceTest {
  
      MemberService memberService;
      MemoryMemberRepository memberRepository;     //  load for data clear after each method finished
  
      @BeforeEach
      public void beforeEach() {
          memberRepository = new MemoryMemberRepository();        // ë§¤ í•¨ìˆ˜ ì‹¤í–‰ ì „ë§ˆë‹¤ ê°ì²´ ìƒì„±
          memberService = new MemberService(memberRepository);
      }
  
  ...
  ```
  
<br>

---

### ğŸ¯ Tip!

- **System.out.println() ì˜ ë‹¨ì¶•í‚¤**ê°€ ì—†ë‚˜? í•˜ë˜ ì¤‘ ì°¾ì€...ã…ã…
  
  - intellij : `sout` íƒ€ì´í•‘ í›„ tab í•˜ë©´ ìë™ì™„ì„±
    
  - ì´í´ë¦½ìŠ¤ : `sysout` í˜¹ì€ `syso` íƒ€ì´í•‘ í›„ `ctrl + space`
